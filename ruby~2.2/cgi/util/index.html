
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>CGI&#58;&#58;Util - Ruby 2.2 - W3cubDocs</title>
  
  <meta name="description" content=" Abbreviated day-of-week names specified by RFC 822 ">
  <meta name="keywords" content="module, cgi, util, -, ruby, ruby~2.2">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ruby~2.2/cgi/util/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/ruby~2.2.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.2/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.2</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _rdoc">
				
<h1 id="module-CGI::Util" class="module"> module CGI::Util </h1>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="RFC822_DAYS">RFC822_DAYS </dt>
<dd>
<p>Abbreviated day-of-week names specified by RFC 822</p> </dd>
<dt id="RFC822_MONTHS">RFC822_MONTHS </dt>
<dd>
<p>Abbreviated month names specified by RFC 822</p> </dd>
<dt id="TABLE_FOR_ESCAPE_HTML__">TABLE_FOR_ESCAPE_HTML__ </dt>
<dd>
<p>The set of special characters and their escaped values</p> </dd>
</dl> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-escape"> <span class="method-name">escape</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>URL-encode a string.</p> <pre class="ruby">url_encoded_string = CGI::escape("'Stop!' said Fred")
   # =&gt; "%27Stop%21%27+said+Fred"
</pre> <div class="method-source-code" id="escape-source"> <pre class="ruby"># File lib/cgi/util.rb, line 7
def escape(string)
  encoding = string.encoding
  string.b.gsub(/([^ a-zA-Z0-9_.-]+)/) do |m|
    '%' + m.unpack('H2' * m.bytesize).join('%').upcase
  end.tr(' ', '+').force_encoding(encoding)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-escapeElement"> <span class="method-name">escapeElement</span><span class="method-args">(string, *elements)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Escape only the tags of certain HTML elements in <code>string</code>.</p> <p>Takes an element or elements or array of elements. Each element is specified by the name of the element, without angle brackets. This matches both the start and the end tag of that element. The attribute list of the open tag will also be escaped (for instance, the double-quotes surrounding attribute values).</p> <pre class="ruby">print CGI::escapeElement('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;', "A", "IMG")
  # "&lt;BR&gt;&amp;lt;A HREF=&amp;quot;url&amp;quot;&amp;gt;&amp;lt;/A&amp;gt"

print CGI::escapeElement('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;', ["A", "IMG"])
  # "&lt;BR&gt;&amp;lt;A HREF=&amp;quot;url&amp;quot;&amp;gt;&amp;lt;/A&amp;gt"
</pre> <div class="method-source-code" id="escapeElement-source"> <pre class="ruby"># File lib/cgi/util.rb, line 111
def escapeElement(string, *elements)
  elements = elements[0] if elements[0].kind_of?(Array)
  unless elements.empty?
    string.gsub(/&lt;\/?(?:#{elements.join("|")})(?!\w)(?:.|\n)*?&gt;/i) do
      CGI::escapeHTML($&amp;)
    end
  else
    string
  end
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../util/#method-i-escape_element">escape_element</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-escapeHTML"> <span class="method-name">escapeHTML</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Escape special characters in HTML, namely &amp;"&lt;&gt;</p> <pre class="ruby">CGI::escapeHTML('Usage: foo "bar" &lt;baz&gt;')
   # =&gt; "Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;"
</pre> <div class="method-source-code" id="escapeHTML-source"> <pre class="ruby"># File lib/cgi/util.rb, line 36
def escapeHTML(string)
  string.gsub(/['&amp;\"&lt;&gt;]/, TABLE_FOR_ESCAPE_HTML__)
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../util/#method-i-escape_html">escape_html</a>, <a href="../util/#method-i-h">h</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-escape_element"> <span class="method-name">escape_element</span><span class="method-args">(string, *elements)</span> </div> <div class="method-description"> <p>Synonym for CGI::escapeElement(str)</p> </div> <div class="aliases"> Alias for: <a href="../util/#method-i-escapeElement">escapeElement</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-escape_html"> <span class="method-name">escape_html</span><span class="method-args">(string)</span> </div> <div class="method-description"> <p>Synonym for CGI::escapeHTML(str)</p> </div> <div class="aliases"> Alias for: <a href="../util/#method-i-escapeHTML">escapeHTML</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-h"> <span class="method-name">h</span><span class="method-args">(string)</span> </div>  <div class="aliases"> Alias for: <a href="../util/#method-i-escapeHTML">escapeHTML</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-pretty"> <span class="method-name">pretty</span><span class="method-args">(string, shift = " ")</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Prettify (indent) an HTML string.</p> <p><code>string</code> is the HTML string to indent. <code>shift</code> is the indentation unit to use; it defaults to two spaces.</p> <pre class="ruby">print CGI::pretty("&lt;HTML&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt;")
  # &lt;HTML&gt;
  #   &lt;BODY&gt;
  #   &lt;/BODY&gt;
  # &lt;/HTML&gt;

print CGI::pretty("&lt;HTML&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt;", "\t")
  # &lt;HTML&gt;
  #         &lt;BODY&gt;
  #         &lt;/BODY&gt;
  # &lt;/HTML&gt;
</pre> <div class="method-source-code" id="pretty-source"> <pre class="ruby"># File lib/cgi/util.rb, line 182
def pretty(string, shift = "  ")
  lines = string.gsub(/(?!\A)&lt;.*?&gt;/m, "\n\\0").gsub(/&lt;.*?&gt;(?!\n)/m, "\\0\n")
  end_pos = 0
  while end_pos = lines.index(/^&lt;\/(\w+)/, end_pos)
    element = $1.dup
    start_pos = lines.rindex(/^\s*&lt;#{element}/i, end_pos)
    lines[start_pos ... end_pos] = "__" + lines[start_pos ... end_pos].gsub(/\n(?!\z)/, "\n" + shift) + "__"
  end
  lines.gsub(/^((?:#{Regexp::quote(shift)})*)__(?=&lt;\/?\w)/, '\1')
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-rfc1123_date"> <span class="method-name">rfc1123_date</span><span class="method-args">(time)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Format a <code>Time</code> object as a String using the format specified by RFC 1123.</p> <pre class="ruby">CGI::rfc1123_date(Time.now)
  # Sat, 01 Jan 2000 00:00:00 GMT
</pre> <div class="method-source-code" id="rfc1123_date-source"> <pre class="ruby"># File lib/cgi/util.rb, line 158
def rfc1123_date(time)
  t = time.clone.gmtime
  return format("%s, %.2d %s %.4d %.2d:%.2d:%.2d GMT",
                RFC822_DAYS[t.wday], t.day, RFC822_MONTHS[t.month-1], t.year,
                t.hour, t.min, t.sec)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unescape"> <span class="method-name">unescape</span><span class="method-args">(string,encoding=@@accept_charset)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>URL-decode a string with encoding(optional).</p> <pre class="ruby">string = CGI::unescape("%27Stop%21%27+said+Fred")
   # =&gt; "'Stop!' said Fred"
</pre> <div class="method-source-code" id="unescape-source"> <pre class="ruby"># File lib/cgi/util.rb, line 17
def unescape(string,encoding=@@accept_charset)
  str=string.tr('+', ' ').b.gsub(/((?:%[0-9a-fA-F]{2})+)/) do |m|
    [m.delete('%')].pack('H*')
  end.force_encoding(encoding)
  str.valid_encoding? ? str : str.force_encoding(string.encoding)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unescapeElement"> <span class="method-name">unescapeElement</span><span class="method-args">(string, *elements)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Undo escaping such as that done by CGI::escapeElement()</p> <pre class="ruby">print CGI::unescapeElement(
        CGI::escapeHTML('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;'), "A", "IMG")
  # "&amp;lt;BR&amp;gt;&lt;A HREF="url"&gt;&lt;/A&gt;"

print CGI::unescapeElement(
        CGI::escapeHTML('&lt;BR&gt;&lt;A HREF="url"&gt;&lt;/A&gt;'), ["A", "IMG"])
  # "&amp;lt;BR&amp;gt;&lt;A HREF="url"&gt;&lt;/A&gt;"
</pre> <div class="method-source-code" id="unescapeElement-source"> <pre class="ruby"># File lib/cgi/util.rb, line 131
def unescapeElement(string, *elements)
  elements = elements[0] if elements[0].kind_of?(Array)
  unless elements.empty?
    string.gsub(/&amp;lt;\/?(?:#{elements.join("|")})(?!\w)(?:.|\n)*?&amp;gt;/i) do
      unescapeHTML($&amp;)
    end
  else
    string
  end
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../util/#method-i-unescape_element">unescape_element</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-unescapeHTML"> <span class="method-name">unescapeHTML</span><span class="method-args">(string)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Unescape a string that has been HTML-escaped</p> <pre class="ruby">CGI::unescapeHTML("Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;")
   # =&gt; "Usage: foo \"bar\" &lt;baz&gt;"
</pre> <div class="method-source-code" id="unescapeHTML-source"> <pre class="ruby"># File lib/cgi/util.rb, line 43
def unescapeHTML(string)
  return string unless string.include? '&amp;'
  enc = string.encoding
  if enc != Encoding::UTF_8 &amp;&amp; [Encoding::UTF_16BE, Encoding::UTF_16LE, Encoding::UTF_32BE, Encoding::UTF_32LE].include?(enc)
    return string.gsub(Regexp.new('&amp;(apos|amp|quot|gt|lt|#[0-9]+|#x[0-9A-Fa-f]+);'.encode(enc))) do
      case $1.encode(Encoding::US_ASCII)
      when 'apos'                then "'".encode(enc)
      when 'amp'                 then '&amp;'.encode(enc)
      when 'quot'                then '"'.encode(enc)
      when 'gt'                  then '&gt;'.encode(enc)
      when 'lt'                  then '&lt;'.encode(enc)
      when /\A#0*(\d+)\z/        then $1.to_i.chr(enc)
      when /\A#x([0-9a-f]+)\z/i  then $1.hex.chr(enc)
      end
    end
  end
  asciicompat = Encoding.compatible?(string, "a")
  string.gsub(/&amp;(apos|amp|quot|gt|lt|\#[0-9]+|\#[xX][0-9A-Fa-f]+);/) do
    match = $1.dup
    case match
    when 'apos'                then "'"
    when 'amp'                 then '&amp;'
    when 'quot'                then '"'
    when 'gt'                  then '&gt;'
    when 'lt'                  then '&lt;'
    when /\A#0*(\d+)\z/
      n = $1.to_i
      if enc == Encoding::UTF_8 or
        enc == Encoding::ISO_8859_1 &amp;&amp; n &lt; 256 or
        asciicompat &amp;&amp; n &lt; 128
        n.chr(enc)
      else
        "&amp;##{$1};"
      end
    when /\A#x([0-9a-f]+)\z/i
      n = $1.hex
      if enc == Encoding::UTF_8 or
        enc == Encoding::ISO_8859_1 &amp;&amp; n &lt; 256 or
        asciicompat &amp;&amp; n &lt; 128
        n.chr(enc)
      else
        "&amp;#x#{$1};"
      end
    else
      "&amp;#{match};"
    end
  end
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../util/#method-i-unescape_html">unescape_html</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-unescape_element"> <span class="method-name">unescape_element</span><span class="method-args">(string, *elements)</span> </div> <div class="method-description"> <p>Synonym for CGI::unescapeElement(str)</p> </div> <div class="aliases"> Alias for: <a href="../util/#method-i-unescapeElement">unescapeElement</a> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-unescape_html"> <span class="method-name">unescape_html</span><span class="method-args">(string)</span> </div> <div class="method-description"> <p>Synonym for CGI::unescapeHTML(str)</p> </div> <div class="aliases"> Alias for: <a href="../util/#method-i-unescapeHTML">unescapeHTML</a> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2016 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
