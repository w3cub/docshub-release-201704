
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Phoenix.Tracker.State - Phoenix - W3cubDocs</title>
  
  <meta name="description" content=" Provides an ORSWOT CRDT. ">
  <meta name="keywords" content="phoenix, tracker, state, summary, types, functions, -">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/phoenix/phoenix_pubsub/phoenix.tracker.state/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/phoenix.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/phoenix/" class="_nav-link" title="" style="margin-left:0;">Phoenix</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _elixir">
				
<h1>  Phoenix.Tracker.State </h1>  <p>Provides an ORSWOT CRDT.</p>   <h1 class="section-heading" id="summary">  Summary </h1> <h2> Types </h2>
<dl class="summary-types summary">   <dt class="summary-signature"> <a href="#t:clock/0">clock()</a> </dt>   <dt class="summary-signature"> <a href="#t:cloud/0">cloud()</a> </dt>   <dt class="summary-signature"> <a href="#t:context/0">context()</a> </dt>   <dt class="summary-signature"> <a href="#t:delta/0">delta()</a> </dt>   <dt class="summary-signature"> <a href="#t:ets_id/0">ets_id()</a> </dt>   <dt class="summary-signature"> <a href="#t:key/0">key()</a> </dt>   <dt class="summary-signature"> <a href="#t:meta/0">meta()</a> </dt>   <dt class="summary-signature"> <a href="#t:name/0">name()</a> </dt>   <dt class="summary-signature"> <a href="#t:pid_lookup/0">pid_lookup()</a> </dt>   <dt class="summary-signature"> <a href="#t:t/0">t()</a> </dt>   <dt class="summary-signature"> <a href="#t:tag/0">tag()</a> </dt>   <dt class="summary-signature"> <a href="#t:topic/0">topic()</a> </dt>   <dt class="summary-signature"> <a href="#t:value/0">value()</a> </dt>   <dt class="summary-signature"> <a href="#t:values/0">values()</a> </dt>  </dl> <h2> Functions </h2>
<dl class="summary-functions summary">   <dt class="summary-signature"> <a href="#clocks/1">clocks(state)</a> </dt> <dd class="summary-synopsis">
<p>Returns the causal context for the set</p> </dd>   <dt class="summary-signature"> <a href="#compact/1">compact(state)</a> </dt> <dd class="summary-synopsis">
<p>Compacts a sets causal history</p> </dd>   <dt class="summary-signature"> <a href="#delta_size/1">delta_size(state)</a> </dt> <dd class="summary-synopsis">
<p>Returns the dize of the delta</p> </dd>   <dt class="summary-signature"> <a href="#extract/1">extract(state)</a> </dt> <dd class="summary-synopsis">
<p>Extracts the set's elements from ets into a mergeable list</p> </dd>   <dt class="summary-signature"> <a href="#get_by_pid/2">get_by_pid(state, pid)</a> </dt> <dd class="summary-synopsis">
<p>Returns all elements for the pid</p> </dd>   <dt class="summary-signature"> <a href="#get_by_pid/4">get_by_pid(state, pid, topic, key)</a> </dt> <dd class="summary-synopsis">
<p>Returns the element matching the pid, topic, and key</p> </dd>   <dt class="summary-signature"> <a href="#get_by_topic/2">get_by_topic(state, topic)</a> </dt> <dd class="summary-synopsis">
<p>Returns a list of elements for the topic who belong to an online replica</p> </dd>   <dt class="summary-signature"> <a href="#has_delta?/1">has_delta?(state)</a> </dt> <dd class="summary-synopsis">
<p>Checks if set has a non-empty delta</p> </dd>   <dt class="summary-signature"> <a href="#join/5">join(state, pid, topic, key, meta \\ %{})</a> </dt> <dd class="summary-synopsis">
<p>Adds a new element to the set</p> </dd>   <dt class="summary-signature"> <a href="#leave/2">leave(state, pid)</a> </dt> <dd class="summary-synopsis">
<p>Removes all elements from the set for the given pid</p> </dd>   <dt class="summary-signature"> <a href="#leave/4">leave(state, pid, topic, key)</a> </dt> <dd class="summary-synopsis">
<p>Removes an element from the set</p> </dd>   <dt class="summary-signature"> <a href="#merge/2">merge(local, remote)</a> </dt> <dd class="summary-synopsis">
<p>Merges two sets, or a delta into a set</p> </dd>   <dt class="summary-signature"> <a href="#merge_deltas/2">merge_deltas(local, remote)</a> </dt>   <dt class="summary-signature"> <a href="#new/1">new(replica)</a> </dt> <dd class="summary-synopsis">
<p>Creates a new set for the replica</p> </dd>   <dt class="summary-signature"> <a href="#online_list/1">online_list(state)</a> </dt> <dd class="summary-synopsis">
<p>Returns a list of elements in the set belonging to an online replica</p> </dd>   <dt class="summary-signature"> <a href="#remove_down_replicas/2">remove_down_replicas(state, replica)</a> </dt> <dd class="summary-synopsis">
<p>Removes all elements for replicas that are permanently gone</p> </dd>   <dt class="summary-signature"> <a href="#replica_down/2">replica_down(state, replica)</a> </dt> <dd class="summary-synopsis">
<p>Marks a replica as down in the set and returns left users</p> </dd>   <dt class="summary-signature"> <a href="#replica_up/2">replica_up(state, replica)</a> </dt> <dd class="summary-synopsis">
<p>Marks a replica as up in the set and returns rejoined users</p> </dd>   <dt class="summary-signature"> <a href="#reset_delta/1">reset_delta(state)</a> </dt> <dd class="summary-synopsis">
<p>Resets the set's delta</p> </dd>  </dl>   <h1 class="section-heading" id="types">  Types </h1>  <div id="t:clock/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:clock/0">clock</a> :: pos_integer</code></pre> </div> <div id="t:cloud/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:cloud/0">cloud</a> :: <a href="http://elixir-lang.org/docs/stable/elixir/MapSet.html#t:t/0" target="_blank">MapSet.t</a></code></pre> </div> <div id="t:context/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:context/0">context</a> :: %{optional(<a href="#t:name/0">name</a>) =&gt; <a href="#t:clock/0">clock</a>}</code></pre> </div> <div id="t:delta/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:delta/0">delta</a> :: %Phoenix.Tracker.State{cloud: term, context: term, delta: term, mode: :delta, pids: term, range: term, replica: term, replicas: term, values: term}</code></pre> </div> <div id="t:ets_id/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:ets_id/0">ets_id</a> :: pos_integer</code></pre> </div> <div id="t:key/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:key/0">key</a> :: term</code></pre> </div> <div id="t:meta/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:meta/0">meta</a> :: <a href="http://elixir-lang.org/docs/stable/elixir/Map.html#t:t/0" target="_blank">Map.t</a></code></pre> </div> <div id="t:name/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:name/0">name</a> :: term</code></pre> </div> <div id="t:pid_lookup/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:pid_lookup/0">pid_lookup</a> :: {pid, <a href="#t:topic/0">topic</a>, <a href="#t:key/0">key</a>}</code></pre> </div> <div id="t:t/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:t/0">t</a> :: %Phoenix.Tracker.State{cloud: <a href="#t:cloud/0">cloud</a>, context: <a href="#t:context/0">context</a>, delta: :unset | <a href="#t:delta/0">delta</a>, mode: :unset | :delta | :normal, pids: <a href="#t:ets_id/0">ets_id</a>, range: {<a href="#t:context/0">context</a>, <a href="#t:context/0">context</a>}, replica: <a href="#t:name/0">name</a>, replicas: %{optional(<a href="#t:name/0">name</a>) =&gt; :up | :down}, values: <a href="#t:values/0">values</a>}</code></pre> </div> <div id="t:tag/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:tag/0">tag</a> :: {<a href="#t:name/0">name</a>, <a href="#t:clock/0">clock</a>}</code></pre> </div> <div id="t:topic/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:topic/0">topic</a> :: <a href="http://elixir-lang.org/docs/stable/elixir/String.html#t:t/0" target="_blank">String.t</a></code></pre> </div> <div id="t:value/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:value/0">value</a> :: {{<a href="#t:topic/0">topic</a>, pid, <a href="#t:key/0">key</a>}, <a href="#t:meta/0">meta</a>, <a href="#t:tag/0">tag</a>}</code></pre> </div> <div id="t:values/0" class="type-detail"> <pre data-language="elixir"><code class="elixir"><a href="#t:values/0">values</a> ::
  <a href="#t:ets_id/0">ets_id</a> |
  :extracted |
  %{optional(<a href="#t:tag/0">tag</a>) =&gt; {pid, <a href="#t:topic/0">topic</a>, <a href="#t:key/0">key</a>, <a href="#t:meta/0">meta</a>}}</code></pre> </div>    <h1 class="section-heading" id="functions">  Functions </h1>  <h3 class="detail-header function" id="clocks/1">  <span class="signature">clocks(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">clocks(<a href="#t:t/0">t</a>) :: {<a href="#t:name/0">name</a>, <a href="#t:context/0">context</a>}</code></pre>    <p>Returns the causal context for the set.</p>    <h3 class="detail-header function" id="compact/1">  <span class="signature">compact(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">compact(<a href="#t:t/0">t</a>) :: <a href="#t:t/0">t</a></code></pre>    <p>Compacts a sets causal history.</p> <p>Called as needed and after merges.</p>    <h3 class="detail-header function" id="delta_size/1">  <span class="signature">delta_size(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">delta_size(<a href="#t:delta/0">delta</a>) :: pos_integer</code></pre>    <p>Returns the dize of the delta.</p>    <h3 class="detail-header function" id="extract/1">  <span class="signature">extract(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">extract(<a href="#t:t/0">t</a>) :: {<a href="#t:t/0">t</a>, <a href="#t:values/0">values</a>}</code></pre>    <p>Extracts the set's elements from ets into a mergeable list.</p> <p>Used when merging two sets.</p>    <h3 class="detail-header function" id="get_by_pid/2">  <span class="signature">get_by_pid(state, pid)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">get_by_pid(<a href="#t:t/0">t</a>, pid) :: [<a href="#t:value/0">value</a>]</code></pre>    <p>Returns all elements for the pid.</p>    <h3 class="detail-header function" id="get_by_pid/4">  <span class="signature">get_by_pid(state, pid, topic, key)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">get_by_pid(<a href="#t:t/0">t</a>, pid, <a href="#t:topic/0">topic</a>, <a href="#t:key/0">key</a>) :: <a href="#t:value/0">value</a> | nil</code></pre>    <p>Returns the element matching the pid, topic, and key.</p>    <h3 class="detail-header function" id="get_by_topic/2">  <span class="signature">get_by_topic(state, topic)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">get_by_topic(<a href="#t:t/0">t</a>, <a href="#t:topic/0">topic</a>) :: [<a href="#t:value/0">value</a>]</code></pre>    <p>Returns a list of elements for the topic who belong to an online replica.</p>    <h3 class="detail-header function" id="has_delta?/1">  <span class="signature">has_delta?(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">has_delta?(<a href="#t:t/0">t</a>) :: boolean</code></pre>    <p>Checks if set has a non-empty delta.</p>    <h3 class="detail-header function" id="join/5">  <span class="signature">join(state, pid, topic, key, meta \\ %{})</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">join(<a href="#t:t/0">t</a>, pid, <a href="#t:topic/0">topic</a>, <a href="#t:key/0">key</a>, <a href="#t:meta/0">meta</a>) :: <a href="#t:t/0">t</a></code></pre>    <p>Adds a new element to the set.</p>    <h3 class="detail-header function" id="leave/2">  <span class="signature">leave(state, pid)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">leave(<a href="#t:t/0">t</a>, pid) :: <a href="#t:t/0">t</a></code></pre>    <p>Removes all elements from the set for the given pid.</p>    <h3 class="detail-header function" id="leave/4">  <span class="signature">leave(state, pid, topic, key)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">leave(<a href="#t:t/0">t</a>, pid, <a href="#t:topic/0">topic</a>, <a href="#t:key/0">key</a>) :: <a href="#t:t/0">t</a></code></pre>    <p>Removes an element from the set.</p>    <h3 class="detail-header function" id="merge/2">  <span class="signature">merge(local, remote)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">merge(local :: <a href="#t:t/0">t</a>, {remote :: <a href="#t:t/0">t</a>, <a href="#t:values/0">values</a>} | <a href="#t:delta/0">delta</a>) :: {new_local :: <a href="#t:t/0">t</a>, joins :: [<a href="#t:value/0">value</a>], leaves :: [<a href="#t:value/0">value</a>]}</code></pre>    <p>Merges two sets, or a delta into a set.</p> <p>Returns a 3-tuple of the updated set, and the joined and left elements.</p> <h4 id="examples">Examples</h4> <pre data-language="elixir"><code class="iex elixir">iex&gt; {s1, joined, left} =
     Phoenix.Tracker.State.merge(s1, Phoenix.Tracker.State.extract(s2))

{%Phoenix.Tracker.State{}, [...], [...]}</code></pre>    <h3 class="detail-header function" id="merge_deltas/2">  <span class="signature">merge_deltas(local, remote)</span> </h3>     <h3 class="detail-header function" id="new/1">  <span class="signature">new(replica)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">new(<a href="#t:name/0">name</a>) :: <a href="#t:t/0">t</a></code></pre>    <p>Creates a new set for the replica.</p> <h4 id="examples">Examples</h4> <pre data-language="elixir"><code class="iex elixir">iex&gt; Phoenix.Tracker.State.new(:replica1)
%Phoenix.Tracker.State{...}</code></pre>    <h3 class="detail-header function" id="online_list/1">  <span class="signature">online_list(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">online_list(<a href="#t:t/0">t</a>) :: [<a href="#t:value/0">value</a>]</code></pre>    <p>Returns a list of elements in the set belonging to an online replica.</p>    <h3 class="detail-header function" id="remove_down_replicas/2">  <span class="signature">remove_down_replicas(state, replica)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">remove_down_replicas(<a href="#t:t/0">t</a>, <a href="#t:name/0">name</a>) :: <a href="#t:t/0">t</a></code></pre>    <p>Removes all elements for replicas that are permanently gone.</p>    <h3 class="detail-header function" id="replica_down/2">  <span class="signature">replica_down(state, replica)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">replica_down(<a href="#t:t/0">t</a>, <a href="#t:name/0">name</a>) :: {<a href="#t:t/0">t</a>, joins :: [], leaves :: [<a href="#t:values/0">values</a>]}</code></pre>    <p>Marks a replica as down in the set and returns left users.</p>    <h3 class="detail-header function" id="replica_up/2">  <span class="signature">replica_up(state, replica)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">replica_up(<a href="#t:t/0">t</a>, <a href="#t:name/0">name</a>) :: {<a href="#t:t/0">t</a>, joins :: [<a href="#t:values/0">values</a>], leaves :: []}</code></pre>    <p>Marks a replica as up in the set and returns rejoined users.</p>    <h3 class="detail-header function" id="reset_delta/1">  <span class="signature">reset_delta(state)</span> </h3>  <h4 class="specs-title">Specs</h4>  <pre data-language="elixir"><code class="elixir">reset_delta(<a href="#t:t/0">t</a>) :: <a href="#t:t/0">t</a></code></pre>    <p>Resets the set's delta.</p>
<div class="_attribution">
  <p class="_attribution-p">
    Â© 2014 Chris McCord<br>Licensed under the MIT License.<br>
    <a href="https://hexdocs.pm/phoenix_pubsub/Phoenix.Tracker.State.html" class="_attribution-link" target="_blank">https://hexdocs.pm/phoenix_pubsub/Phoenix.Tracker.State.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
