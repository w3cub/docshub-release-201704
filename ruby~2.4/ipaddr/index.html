
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>IPAddr - Ruby 2.4 - W3cubDocs</title>
  
  <meta name="description" content=" IPAddr provides a set of methods to manipulate an IP address. Both IPv4 and IPv6 are supported. ">
  <meta name="keywords" content="class, ipaddr, -, ruby, ruby~2.4">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/ruby~2.4/ipaddr/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/ruby~2.4.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/ruby~2.4/" class="_nav-link" title="" style="margin-left:0;">Ruby 2.4</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _rdoc">
				
<h1 id="class-IPAddr" class="class"> class IPAddr </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object/">Object</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><a class="include" href="../comparable/">Comparable</a></dd>
</dl> <section class="description"> <p><a href="../ipaddr/">IPAddr</a> provides a set of methods to manipulate an IP address. Both IPv4 and IPv6 are supported.</p> <h2 id="class-IPAddr-label-Example">Example</h2> <pre class="ruby" data-language="ruby">require 'ipaddr'

ipaddr1 = IPAddr.new "3ffe:505:2::1"

p ipaddr1                   #=&gt; #&lt;IPAddr: IPv6:3ffe:0505:0002:0000:0000:0000:0000:0001/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&gt;

p ipaddr1.to_s              #=&gt; "3ffe:505:2::1"

ipaddr2 = ipaddr1.mask(48)  #=&gt; #&lt;IPAddr: IPv6:3ffe:0505:0002:0000:0000:0000:0000:0000/ffff:ffff:ffff:0000:0000:0000:0000:0000&gt;

p ipaddr2.to_s              #=&gt; "3ffe:505:2::"

ipaddr3 = IPAddr.new "192.168.2.0/24"

p ipaddr3                   #=&gt; #&lt;IPAddr: IPv4:192.168.2.0/255.255.255.0&gt;
</pre> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="IN4MASK">IN4MASK </dt>
<dd>
<p>32 bit mask for IPv4</p> </dd>
<dt id="IN6FORMAT">IN6FORMAT </dt>
<dd>
<p>Format string for IPv6</p> </dd>
<dt id="IN6MASK">IN6MASK </dt>
<dd>
<p>128 bit mask for IPv6</p> </dd>
<dt id="RE_IPV4ADDRLIKE">RE_IPV4ADDRLIKE </dt>
<dd>
<p><a href="../regexp/">Regexp</a> <em>internally</em> used for parsing IPv4 address.</p> </dd>
<dt id="RE_IPV6ADDRLIKE_COMPRESSED">RE_IPV6ADDRLIKE_COMPRESSED </dt>
<dd>
<p><a href="../regexp/">Regexp</a> <em>internally</em> used for parsing IPv6 address.</p> </dd>
<dt id="RE_IPV6ADDRLIKE_FULL">RE_IPV6ADDRLIKE_FULL </dt>
<dd>
<p><a href="../regexp/">Regexp</a> <em>internally</em> used for parsing IPv6 address.</p> </dd>
</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-family"> <span class="method-name">family</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>Returns the address family of this IP address.</p> </div> </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(addr = '::', family = Socket::AF_UNSPEC)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Creates a new ipaddr object either from a human readable IP address representation in string, or from a packed <a href="../ipaddr/#method-i-in_addr">#in_addr</a> value followed by an address family.</p> <p>In the former case, the following are the valid formats that will be recognized: “address”, “address/prefixlen” and “address/mask”, where IPv6 address may be enclosed in square brackets (`[' and `]'). If a prefixlen or a mask is specified, it returns a masked IP address. Although the address family is determined automatically from a specified string, you can specify one explicitly by the optional second argument.</p> <p>Otherwise an IP address is generated from a packed <a href="../ipaddr/#method-i-in_addr">#in_addr</a> value and an address family.</p> <p>The <a href="../ipaddr/">IPAddr</a> class defines many methods and operators, and some of those, such as &amp;, |, include? and ==, accept a string, or a packed <a href="../ipaddr/#method-i-in_addr">#in_addr</a> value instead of an <a href="../ipaddr/">IPAddr</a> object.</p> <div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 470
def initialize(addr = '::', family = Socket::AF_UNSPEC)
  if !addr.kind_of?(String)
    case family
    when Socket::AF_INET, Socket::AF_INET6
      set(addr.to_i, family)
      @mask_addr = (family == Socket::AF_INET) ? IN4MASK : IN6MASK
      return
    when Socket::AF_UNSPEC
      raise AddressFamilyError, "address family must be specified"
    else
      raise AddressFamilyError, "unsupported address family: #{family}"
    end
  end
  prefix, prefixlen = addr.split('/')
  if prefix =~ /\A\[(.*)\]\z/i
    prefix = $1
    family = Socket::AF_INET6
  end
  # It seems AI_NUMERICHOST doesn't do the job.
  #Socket.getaddrinfo(left, nil, Socket::AF_INET6, Socket::SOCK_STREAM, nil,
  #                  Socket::AI_NUMERICHOST)
  @addr = @family = nil
  if family == Socket::AF_UNSPEC || family == Socket::AF_INET
    @addr = in_addr(prefix)
    if @addr
      @family = Socket::AF_INET
    end
  end
  if !@addr &amp;&amp; (family == Socket::AF_UNSPEC || family == Socket::AF_INET6)
    @addr = in6_addr(prefix)
    @family = Socket::AF_INET6
  end
  if family != Socket::AF_UNSPEC &amp;&amp; @family != family
    raise AddressFamilyError, "address family mismatch"
  end
  if prefixlen
    mask!(prefixlen)
  else
    @mask_addr = (@family == Socket::AF_INET) ? IN4MASK : IN6MASK
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-new_ntoh"> <span class="method-name">new_ntoh</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Creates a new ipaddr containing the given network byte ordered string form of an IP address.</p> <div class="method-source-code" id="new_ntoh-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 105
def IPAddr::new_ntoh(addr)
  return IPAddr.new(IPAddr::ntop(addr))
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-c-ntop"> <span class="method-name">ntop</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Convert a network byte ordered string form of an IP address into human readable form.</p> <div class="method-source-code" id="ntop-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 111
def IPAddr::ntop(addr)
  case addr.size
  when 4
    s = addr.unpack('C4').join('.')
  when 16
    s = IN6FORMAT % addr.unpack('n8')
  else
    raise AddressFamilyError, "unsupported address family"
  end
  return s
end</pre> </div> </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-26"> <span class="method-name">&amp;</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by bitwise AND.</p> <div class="method-source-code" id="26-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 124
def &amp;(other)
  return self.clone.set(@addr &amp; coerce_other(other).to_i)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3C-3C"> <span class="method-name">&lt;&lt;</span><span class="method-args">(num)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by bitwise left shift.</p> <div class="method-source-code" id="3C-3C-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 139
def &lt;&lt;(num)
  return self.clone.set(addr_mask(@addr &lt;&lt; num))
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3C-3D-3E"> <span class="method-name">&lt;=&gt;</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Compares the ipaddr with another.</p> <div class="method-source-code" id="3C-3D-3E-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 338
def &lt;=&gt;(other)
  other = coerce_other(other)
rescue
  nil
else
  @addr &lt;=&gt; other.to_i if other.family == @family
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3D-3D"> <span class="method-name">==</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns true if two ipaddrs are equal.</p> <div class="method-source-code" id="3D-3D-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 149
def ==(other)
  other = coerce_other(other)
rescue
  false
else
  @family == other.family &amp;&amp; @addr == other.to_i
end</pre> </div> </div> </div> <div class="method-detail method-alias"> <div class="method-heading" id="method-i-3D-3D-3D"> <span class="method-name">===</span><span class="method-args">(other)</span> </div>  <div class="aliases"> Alias for: <a href="../ipaddr/#method-i-include-3F">include?</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-3E-3E"> <span class="method-name">&gt;&gt;</span><span class="method-args">(num)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by bitwise right-shift.</p> <div class="method-source-code" id="3E-3E-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 134
def &gt;&gt;(num)
  return self.clone.set(@addr &gt;&gt; num)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-eql-3F"> <span class="method-name">eql?</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Checks equality used by <a href="../hash/">Hash</a>.</p> <div class="method-source-code" id="eql-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 348
def eql?(other)
  return self.class == other.class &amp;&amp; self.hash == other.hash &amp;&amp; self == other
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-hash"> <span class="method-name">hash</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a hash value used by <a href="../hash/">Hash</a>, <a href="../set/">Set</a>, and Array classes</p> <div class="method-source-code" id="hash-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 353
def hash
  return ([@addr, @mask_addr].hash &lt;&lt; 1) | (ipv4? ? 0 : 1)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-hton"> <span class="method-name">hton</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a network byte ordered string form of the IP address.</p> <div class="method-source-code" id="hton-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 238
def hton
  case @family
  when Socket::AF_INET
    return [@addr].pack('N')
  when Socket::AF_INET6
    return (0..7).map { |i|
      (@addr &gt;&gt; (112 - 16 * i)) &amp; 0xffff
    }.pack('n8')
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-include-3F"> <span class="method-name">include?</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns true if the given ipaddr is in the range.</p> <p>e.g.:</p> <pre class="ruby" data-language="ruby">require 'ipaddr'
net1 = IPAddr.new("192.168.2.0/24")
net2 = IPAddr.new("192.168.2.100")
net3 = IPAddr.new("192.168.3.0")
p net1.include?(net2)     #=&gt; true
p net1.include?(net3)     #=&gt; false
</pre> <div class="method-source-code" id="include-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 172
def include?(other)
  other = coerce_other(other)
  if ipv4_mapped?
    if (@mask_addr &gt;&gt; 32) != 0xffffffffffffffffffffffff
      return false
    end
    mask_addr = (@mask_addr &amp; IN4MASK)
    addr = (@addr &amp; IN4MASK)
    family = Socket::AF_INET
  else
    mask_addr = @mask_addr
    addr = @addr
    family = @family
  end
  if other.ipv4_mapped?
    other_addr = (other.to_i &amp; IN4MASK)
    other_family = Socket::AF_INET
  else
    other_addr = other.to_i
    other_family = other.family
  end

  if family != other_family
    return false
  end
  return ((addr &amp; mask_addr) == (other_addr &amp; mask_addr))
end</pre> </div> </div> <div class="aliases"> Also aliased as: <a href="../ipaddr/#method-i-3D-3D-3D">===</a> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-inspect"> <span class="method-name">inspect</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a string containing a human-readable representation of the ipaddr. (“#&lt;IPAddr: family:address/mask&gt;”)</p> <div class="method-source-code" id="inspect-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 375
def inspect
  case @family
  when Socket::AF_INET
    af = "IPv4"
  when Socket::AF_INET6
    af = "IPv6"
  else
    raise AddressFamilyError, "unsupported address family"
  end
  return sprintf("#&lt;%s: %s:%s/%s&gt;", self.class.name,
                 af, _to_string(@addr), _to_string(@mask_addr))
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ip6_arpa"> <span class="method-name">ip6_arpa</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a string for DNS reverse lookup compatible with RFC3172.</p> <div class="method-source-code" id="ip6_arpa-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 317
def ip6_arpa
  if !ipv6?
    raise InvalidAddressError, "not an IPv6 address"
  end
  return _reverse + ".ip6.arpa"
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ip6_int"> <span class="method-name">ip6_int</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a string for DNS reverse lookup compatible with RFC1886.</p> <div class="method-source-code" id="ip6_int-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 325
def ip6_int
  if !ipv6?
    raise InvalidAddressError, "not an IPv6 address"
  end
  return _reverse + ".ip6.int"
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4-3F"> <span class="method-name">ipv4?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns true if the ipaddr is an IPv4 address.</p> <div class="method-source-code" id="ipv4-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 252
def ipv4?
  return @family == Socket::AF_INET
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_compat"> <span class="method-name">ipv4_compat</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by converting the native IPv4 address into an IPv4-compatible IPv6 address.</p> <div class="method-source-code" id="ipv4_compat-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 286
def ipv4_compat
  if !ipv4?
    raise InvalidAddressError, "not an IPv4 address"
  end
  return self.clone.set(@addr, Socket::AF_INET6)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_compat-3F"> <span class="method-name">ipv4_compat?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns true if the ipaddr is an IPv4-compatible IPv6 address.</p> <div class="method-source-code" id="ipv4_compat-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 267
def ipv4_compat?
  if !ipv6? || (@addr &gt;&gt; 32) != 0
    return false
  end
  a = (@addr &amp; IN4MASK)
  return a != 0 &amp;&amp; a != 1
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_mapped"> <span class="method-name">ipv4_mapped</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by converting the native IPv4 address into an IPv4-mapped IPv6 address.</p> <div class="method-source-code" id="ipv4_mapped-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 277
def ipv4_mapped
  if !ipv4?
    raise InvalidAddressError, "not an IPv4 address"
  end
  return self.clone.set(@addr | 0xffff00000000, Socket::AF_INET6)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv4_mapped-3F"> <span class="method-name">ipv4_mapped?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns true if the ipaddr is an IPv4-mapped IPv6 address.</p> <div class="method-source-code" id="ipv4_mapped-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 262
def ipv4_mapped?
  return ipv6? &amp;&amp; (@addr &gt;&gt; 32) == 0xffff
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-ipv6-3F"> <span class="method-name">ipv6?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns true if the ipaddr is an IPv6 address.</p> <div class="method-source-code" id="ipv6-3F-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 257
def ipv6?
  return @family == Socket::AF_INET6
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-mask"> <span class="method-name">mask</span><span class="method-args">(prefixlen)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by masking IP address with the given prefixlen/netmask. (e.g. 8, 64, “255.255.255.0”, etc.)</p> <div class="method-source-code" id="mask-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 159
def mask(prefixlen)
  return self.clone.mask!(prefixlen)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-native"> <span class="method-name">native</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by converting the IPv6 address into a native IPv4 address. If the IP address is not an IPv4-mapped or IPv4-compatible IPv6 address, returns self.</p> <div class="method-source-code" id="native-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 296
def native
  if !ipv4_mapped? &amp;&amp; !ipv4_compat?
    return self
  end
  return self.clone.set(@addr &amp; IN4MASK, Socket::AF_INET)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-reverse"> <span class="method-name">reverse</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a string for DNS reverse lookup. It returns a string in RFC3172 form for an IPv6 address.</p> <div class="method-source-code" id="reverse-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 305
def reverse
  case @family
  when Socket::AF_INET
    return _reverse + ".in-addr.arpa"
  when Socket::AF_INET6
    return ip6_arpa
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-succ"> <span class="method-name">succ</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the successor to the ipaddr.</p> <div class="method-source-code" id="succ-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 333
def succ
  return self.clone.set(@addr + 1, @family)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_i"> <span class="method-name">to_i</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns the integer representation of the ipaddr.</p> <div class="method-source-code" id="to_i-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 202
def to_i
  return @addr
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_range"> <span class="method-name">to_range</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Creates a <a href="../range/">Range</a> object for the network address.</p> <div class="method-source-code" id="to_range-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 358
def to_range
  begin_addr = (@addr &amp; @mask_addr)

  case @family
  when Socket::AF_INET
    end_addr = (@addr | (IN4MASK ^ @mask_addr))
  when Socket::AF_INET6
    end_addr = (@addr | (IN6MASK ^ @mask_addr))
  else
    raise AddressFamilyError, "unsupported address family"
  end

  return clone.set(begin_addr, @family)..clone.set(end_addr, @family)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_s"> <span class="method-name">to_s</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a string containing the IP address representation.</p> <div class="method-source-code" id="to_s-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 207
def to_s
  str = to_string
  return str if ipv4?

  str.gsub!(/\b0{1,3}([\da-f]+)\b/i, '\1')
  loop do
    break if str.sub!(/\A0:0:0:0:0:0:0:0\z/, '::')
    break if str.sub!(/\b0:0:0:0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0:0\b/, ':')
    break if str.sub!(/\b0:0:0\b/, ':')
    break if str.sub!(/\b0:0\b/, ':')
    break
  end
  str.sub!(/:{3,}/, '::')

  if /\A::(ffff:)?([\da-f]{1,4}):([\da-f]{1,4})\z/i =~ str
    str = sprintf('::%s%d.%d.%d.%d', $1, $2.hex / 256, $2.hex % 256, $3.hex / 256, $3.hex % 256)
  end

  str
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-to_string"> <span class="method-name">to_string</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a string containing the IP address representation in canonical form.</p> <div class="method-source-code" id="to_string-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 233
def to_string
  return _to_string(@addr)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-7C"> <span class="method-name">|</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by bitwise OR.</p> <div class="method-source-code" id="7C-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 129
def |(other)
  return self.clone.set(@addr | coerce_other(other).to_i)
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-7E"> <span class="method-name">~</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p>Returns a new ipaddr built by bitwise negation.</p> <div class="method-source-code" id="7E-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 144
def ~
  return self.clone.set(addr_mask(~@addr))
end</pre> </div> </div> </div> </section> <section id="protected-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Protected Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-mask-21"> <span class="method-name">mask!</span><span class="method-args">(mask)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p><a href="../set/">Set</a> current netmask to given mask.</p> <div class="method-source-code" id="mask-21-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 414
def mask!(mask)
  if mask.kind_of?(String)
    if mask =~ /\A\d+\z/
      prefixlen = mask.to_i
    else
      m = IPAddr.new(mask)
      if m.family != @family
        raise InvalidPrefixError, "address family is not same"
      end
      @mask_addr = m.to_i
      @addr &amp;= @mask_addr
      return self
    end
  else
    prefixlen = mask
  end
  case @family
  when Socket::AF_INET
    if prefixlen &lt; 0 || prefixlen &gt; 32
      raise InvalidPrefixError, "invalid length"
    end
    masklen = 32 - prefixlen
    @mask_addr = ((IN4MASK &gt;&gt; masklen) &lt;&lt; masklen)
  when Socket::AF_INET6
    if prefixlen &lt; 0 || prefixlen &gt; 128
      raise InvalidPrefixError, "invalid length"
    end
    masklen = 128 - prefixlen
    @mask_addr = ((IN6MASK &gt;&gt; masklen) &lt;&lt; masklen)
  else
    raise AddressFamilyError, "unsupported address family"
  end
  @addr = ((@addr &gt;&gt; masklen) &lt;&lt; masklen)
  return self
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-set"> <span class="method-name">set</span><span class="method-args">(addr, *family)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <p><a href="../set/">Set</a> +@addr+, the internal stored ip address, to given <code>addr</code>. The parameter <code>addr</code> is validated using the first <code>family</code> member, which is <code>Socket::AF_INET</code> or <code>Socket::AF_INET6</code>.</p> <div class="method-source-code" id="set-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 393
def set(addr, *family)
  case family[0] ? family[0] : @family
  when Socket::AF_INET
    if addr &lt; 0 || addr &gt; IN4MASK
      raise InvalidAddressError, "invalid address"
    end
  when Socket::AF_INET6
    if addr &lt; 0 || addr &gt; IN6MASK
      raise InvalidAddressError, "invalid address"
    end
  else
    raise AddressFamilyError, "unsupported address family"
  end
  @addr = addr
  if family[0]
    @family = family[0]
  end
  return self
end</pre> </div> </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-heading" id="method-i-_reverse"> <span class="method-name">_reverse</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="_reverse-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 586
def _reverse
  case @family
  when Socket::AF_INET
    return (0..3).map { |i|
      (@addr &gt;&gt; (8 * i)) &amp; 0xff
    }.join('.')
  when Socket::AF_INET6
    return ("%.32x" % @addr).reverse!.gsub!(/.(?!$)/, '\&amp;.')
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-_to_string"> <span class="method-name">_to_string</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="_to_string-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 599
def _to_string(addr)
  case @family
  when Socket::AF_INET
    return (0..3).map { |i|
      (addr &gt;&gt; (24 - 8 * i)) &amp; 0xff
    }.join('.')
  when Socket::AF_INET6
    return (("%.32x" % addr).gsub!(/.{4}(?!$)/, '\&amp;:'))
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-addr_mask"> <span class="method-name">addr_mask</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="addr_mask-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 575
def addr_mask(addr)
  case @family
  when Socket::AF_INET
    return addr &amp; IN4MASK
  when Socket::AF_INET6
    return addr &amp; IN6MASK
  else
    raise AddressFamilyError, "unsupported address family"
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-coerce_other"> <span class="method-name">coerce_other</span><span class="method-args">(other)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="coerce_other-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 512
def coerce_other(other)
  case other
  when IPAddr
    other
  when String
    self.class.new(other)
  else
    self.class.new(other, @family)
  end
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-in6_addr"> <span class="method-name">in6_addr</span><span class="method-args">(left)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="in6_addr-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 538
def in6_addr(left)
  case left
  when RE_IPV6ADDRLIKE_FULL
    if $2
      addr = in_addr($~[2,4])
      left = $1 + ':'
    else
      addr = 0
    end
    right = ''
  when RE_IPV6ADDRLIKE_COMPRESSED
    if $4
      left.count(':') &lt;= 6 or raise InvalidAddressError, "invalid address"
      addr = in_addr($~[4,4])
      left = $1
      right = $3 + '0:0'
    else
      left.count(':') &lt;= ($1.empty? || $2.empty? ? 8 : 7) or
        raise InvalidAddressError, "invalid address"
      left = $1
      right = $2
      addr = 0
    end
  else
    raise InvalidAddressError, "invalid address"
  end
  l = left.split(':')
  r = right.split(':')
  rest = 8 - l.size - r.size
  if rest &lt; 0
    return nil
  end
  (l + Array.new(rest, '0') + r).inject(0) { |i, s|
    i &lt;&lt; 16 | s.hex
  } | addr
end</pre> </div> </div> </div> <div class="method-detail "> <div class="method-heading" id="method-i-in_addr"> <span class="method-name">in_addr</span><span class="method-args">(addr)</span> <a class="method-click-advice">Show source</a> </div> <div class="method-description"> <div class="method-source-code" id="in_addr-source"> <pre class="ruby" data-language="ruby"># File lib/ipaddr.rb, line 523
def in_addr(addr)
  case addr
  when Array
    octets = addr
  else
    m = RE_IPV4ADDRLIKE.match(addr) or return nil
    octets = m.captures
  end
  octets.inject(0) { |i, s|
    (n = s.to_i) &lt; 256 or raise InvalidAddressError, "invalid address"
    s.match(/\A0./) and raise InvalidAddressError, "zero-filled number in IPv4 address is ambiguous"
    i &lt;&lt; 8 | n
  }
end</pre> </div> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core © 1993–2016 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library © contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
