
<!DOCTYPE HTML>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>ALTER TABLE - PostgreSQL 9.6 - W3cubDocs</title>
  
  <meta name="description" content="ALTER TABLE changes the definition of an existing table. There are several subforms described below. Note that the lock level required may differ &hellip;">
  <meta name="keywords" content="alter, table, -, postgresql, postgresql~9.6">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  
  <link rel="canonical" href="http://docs.w3cub.com/postgresql~9.6/sql-altertable/">
  <link href="/favicon.png" rel="icon">
  <link type="text/css" rel="stylesheet" href="/assets/application-50364fff564ce3b6327021805f3f00e2957b441cf27f576a7dd4ff63bbc47047.css">
  <script type="text/javascript" src="/assets/application-db64bfd54ceb42be11af7995804cf4902548419ceb79d509b0b7d62c22d98e6f.js"></script>
  <script src="/json/postgresql~9.6.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71174418-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<div class="_app">
	<header class="_header">
  
  <form class="_search">
    <input type="search" class="_search-input" placeholder="Search&hellip;" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" maxlength="20">
    <a class="_search-clear"></a>
    <div class="_search-tag"></div>
  </form>
  
  <a class="_home-link" href="/" ></a>
  <a class="_menu-link"></a>
  <h1 class="_logo">
    <a href="/" class="_nav-link" title="API Documentation Browser">W3cubDocs</a>
  </h1>
  
  <span class="_logo-sub-nav">/</span><span class="_logo-sub-nav"><a href="/postgresql~9.6/" class="_nav-link" title="" style="margin-left:0;">PostgreSQL 9.6</a></span>
  
  <nav class="_nav">
    <a href="/app/" class="_nav-link ">App</a>
    <a href="/about/" class="_nav-link ">About</a>
  </nav>
</header>
	<section class="_sidebar">
		<div class="_list">
			
		</div>
	</section>
	<section class="_container ">
		<div class="_content">
			<div class="_page _postgres">
				
<h1 id="SQL-ALTERTABLE">ALTER TABLE</h1> <div class="REFNAMEDIV" id="AEN75271">  <h2>Name</h2>ALTER TABLE -- change the definition of a table </div> <div class="REFSYNOPSISDIV" id="AEN75274">  <h2>Synopsis</h2> <pre class="SYNOPSIS" data-language="sql">
ALTER TABLE [ IF EXISTS ] [ ONLY ] name [ * ]
    action [, ... ]
ALTER TABLE [ IF EXISTS ] [ ONLY ] name [ * ]
    RENAME [ COLUMN ] column_name TO new_column_name
ALTER TABLE [ IF EXISTS ] [ ONLY ] name [ * ]
    RENAME CONSTRAINT constraint_name TO new_constraint_name
ALTER TABLE [ IF EXISTS ] name
    RENAME TO new_name
ALTER TABLE [ IF EXISTS ] name
    SET SCHEMA new_schema
ALTER TABLE ALL IN TABLESPACE name [ OWNED BY role_name [, ... ] ]
    SET TABLESPACE new_tablespace [ NOWAIT ]

where action is one of:

    ADD [ COLUMN ] [ IF NOT EXISTS ] column_name data_type [ COLLATE collation ] [ column_constraint [ ... ] ]
    DROP [ COLUMN ] [ IF EXISTS ] column_name [ RESTRICT | CASCADE ]
    ALTER [ COLUMN ] column_name [ SET DATA ] TYPE data_type [ COLLATE collation ] [ USING expression ]
    ALTER [ COLUMN ] column_name SET DEFAULT expression
    ALTER [ COLUMN ] column_name DROP DEFAULT
    ALTER [ COLUMN ] column_name { SET | DROP } NOT NULL
    ALTER [ COLUMN ] column_name SET STATISTICS integer
    ALTER [ COLUMN ] column_name SET ( attribute_option = value [, ... ] )
    ALTER [ COLUMN ] column_name RESET ( attribute_option [, ... ] )
    ALTER [ COLUMN ] column_name SET STORAGE { PLAIN | EXTERNAL | EXTENDED | MAIN }
    ADD table_constraint [ NOT VALID ]
    ADD table_constraint_using_index
    ALTER CONSTRAINT constraint_name [ DEFERRABLE | NOT DEFERRABLE ] [ INITIALLY DEFERRED | INITIALLY IMMEDIATE ]
    VALIDATE CONSTRAINT constraint_name
    DROP CONSTRAINT [ IF EXISTS ]  constraint_name [ RESTRICT | CASCADE ]
    DISABLE TRIGGER [ trigger_name | ALL | USER ]
    ENABLE TRIGGER [ trigger_name | ALL | USER ]
    ENABLE REPLICA TRIGGER trigger_name
    ENABLE ALWAYS TRIGGER trigger_name
    DISABLE RULE rewrite_rule_name
    ENABLE RULE rewrite_rule_name
    ENABLE REPLICA RULE rewrite_rule_name
    ENABLE ALWAYS RULE rewrite_rule_name
    DISABLE ROW LEVEL SECURITY
    ENABLE ROW LEVEL SECURITY
    FORCE ROW LEVEL SECURITY
    NO FORCE ROW LEVEL SECURITY
    CLUSTER ON index_name
    SET WITHOUT CLUSTER
    SET WITH OIDS
    SET WITHOUT OIDS
    SET TABLESPACE new_tablespace
    SET { LOGGED | UNLOGGED }
    SET ( storage_parameter = value [, ... ] )
    RESET ( storage_parameter [, ... ] )
    INHERIT parent_table
    NO INHERIT parent_table
    OF type_name
    NOT OF
    OWNER TO { new_owner | CURRENT_USER | SESSION_USER }
    REPLICA IDENTITY { DEFAULT | USING INDEX index_name | FULL | NOTHING }

and table_constraint_using_index is:

    [ CONSTRAINT constraint_name ]
    { UNIQUE | PRIMARY KEY } USING INDEX index_name
    [ DEFERRABLE | NOT DEFERRABLE ] [ INITIALLY DEFERRED | INITIALLY IMMEDIATE ]
</pre> </div> <div class="REFSECT1" id="AEN75341">  <h2>Description</h2> <p><code class="COMMAND">ALTER TABLE</code> changes the definition of an existing table. There are several subforms described below. Note that the lock level required may differ for each subform. An <code class="LITERAL">ACCESS EXCLUSIVE</code> lock is held unless explicitly noted. When multiple subcommands are listed, the lock held will be the strictest one required from any subcommand.</p> <div class="VARIABLELIST"> <dl> <dt><code class="LITERAL">ADD COLUMN [ IF NOT EXISTS ]</code></dt> <dd> <p>This form adds a new column to the table, using the same syntax as <a href="../sql-createtable/">CREATE TABLE</a>. If <code class="LITERAL">IF NOT EXISTS</code> is specified and a column already exists with this name, no error is thrown.</p> </dd> <dt><code class="LITERAL">DROP COLUMN [ IF EXISTS ]</code></dt> <dd> <p>This form drops a column from a table. Indexes and table constraints involving the column will be automatically dropped as well. You will need to say <code class="LITERAL">CASCADE</code> if anything outside the table depends on the column, for example, foreign key references or views. If <code class="LITERAL">IF EXISTS</code> is specified and the column does not exist, no error is thrown. In this case a notice is issued instead.</p> </dd> <dt><code class="LITERAL">SET DATA TYPE</code></dt> <dd> <p>This form changes the type of a column of a table. Indexes and simple table constraints involving the column will be automatically converted to use the new column type by reparsing the originally supplied expression. The optional <code class="LITERAL">COLLATE</code> clause specifies a collation for the new column; if omitted, the collation is the default for the new column type. The optional <code class="LITERAL">USING</code> clause specifies how to compute the new column value from the old; if omitted, the default conversion is the same as an assignment cast from old data type to new. A <code class="LITERAL">USING</code> clause must be provided if there is no implicit or assignment cast from old to new type.</p> </dd> <dt>
<code class="LITERAL">SET</code>/<code class="LITERAL">DROP DEFAULT</code>
</dt> <dd> <p>These forms set or remove the default value for a column. Default values only apply in subsequent <code class="COMMAND">INSERT</code> or <code class="COMMAND">UPDATE</code> commands; they do not cause rows already in the table to change.</p> </dd> <dt>
<code class="LITERAL">SET</code>/<code class="LITERAL">DROP NOT NULL</code>
</dt> <dd> <p>These forms change whether a column is marked to allow null values or to reject null values. You can only use <code class="LITERAL">SET NOT NULL</code> when the column contains no null values.</p> </dd> <dt><code class="LITERAL">SET STATISTICS</code></dt> <dd> <p>This form sets the per-column statistics-gathering target for subsequent <a href="../sql-analyze/">ANALYZE</a> operations. The target can be set in the range 0 to 10000; alternatively, set it to -1 to revert to using the system default statistics target (<a href="../runtime-config-query/#GUC-DEFAULT-STATISTICS-TARGET">default_statistics_target</a>). For more information on the use of statistics by the <span class="PRODUCTNAME">PostgreSQL</span> query planner, refer to <a href="../planner-stats/">Section 14.2</a>.</p> <p><code class="LITERAL">SET STATISTICS</code> acquires a <code class="LITERAL">SHARE UPDATE EXCLUSIVE</code> lock.</p> </dd> <dt>
<code class="LITERAL">SET ( <code class="REPLACEABLE c2">attribute_option</code> = <code class="REPLACEABLE c2">value</code> [, ... ] )</code><br> <code class="LITERAL">RESET ( <code class="REPLACEABLE c2">attribute_option</code> [, ... ] )</code>
</dt> <dd> <p>This form sets or resets per-attribute options. Currently, the only defined per-attribute options are <code class="LITERAL">n_distinct</code> and <code class="LITERAL">n_distinct_inherited</code>, which override the number-of-distinct-values estimates made by subsequent <a href="../sql-analyze/">ANALYZE</a> operations. <code class="LITERAL">n_distinct</code> affects the statistics for the table itself, while <code class="LITERAL">n_distinct_inherited</code> affects the statistics gathered for the table plus its inheritance children. When set to a positive value, <code class="COMMAND">ANALYZE</code> will assume that the column contains exactly the specified number of distinct nonnull values. When set to a negative value, which must be greater than or equal to -1, <code class="COMMAND">ANALYZE</code> will assume that the number of distinct nonnull values in the column is linear in the size of the table; the exact count is to be computed by multiplying the estimated table size by the absolute value of the given number. For example, a value of -1 implies that all values in the column are distinct, while a value of -0.5 implies that each value appears twice on the average. This can be useful when the size of the table changes over time, since the multiplication by the number of rows in the table is not performed until query planning time. Specify a value of 0 to revert to estimating the number of distinct values normally. For more information on the use of statistics by the <span class="PRODUCTNAME">PostgreSQL</span> query planner, refer to <a href="../planner-stats/">Section 14.2</a>.</p> <p>Changing per-attribute options acquires a <code class="LITERAL">SHARE UPDATE EXCLUSIVE</code> lock.</p> </dd> <dt><code class="LITERAL">SET STORAGE</code></dt> <dd> <p>This form sets the storage mode for a column. This controls whether this column is held inline or in a secondary <acronym class="ACRONYM">TOAST</acronym> table, and whether the data should be compressed or not. <code class="LITERAL">PLAIN</code> must be used for fixed-length values such as <code class="TYPE">integer</code> and is inline, uncompressed. <code class="LITERAL">MAIN</code> is for inline, compressible data. <code class="LITERAL">EXTERNAL</code> is for external, uncompressed data, and <code class="LITERAL">EXTENDED</code> is for external, compressed data. <code class="LITERAL">EXTENDED</code> is the default for most data types that support non-<code class="LITERAL">PLAIN</code> storage. Use of <code class="LITERAL">EXTERNAL</code> will make substring operations on very large <code class="TYPE">text</code> and <code class="TYPE">bytea</code> values run faster, at the penalty of increased storage space. Note that <code class="LITERAL">SET STORAGE</code> doesn't itself change anything in the table, it just sets the strategy to be pursued during future table updates. See <a href="../storage-toast/">Section 65.2</a> for more information.</p> </dd> <dt><code class="LITERAL">ADD <code class="REPLACEABLE c2">table_constraint</code> [ NOT VALID ]</code></dt> <dd> <p>This form adds a new constraint to a table using the same syntax as <a href="../sql-createtable/">CREATE TABLE</a>, plus the option <code class="LITERAL">NOT VALID</code>, which is currently only allowed for foreign key and CHECK constraints. If the constraint is marked <code class="LITERAL">NOT VALID</code>, the potentially-lengthy initial check to verify that all rows in the table satisfy the constraint is skipped. The constraint will still be enforced against subsequent inserts or updates (that is, they'll fail unless there is a matching row in the referenced table, in the case of foreign keys; and they'll fail unless the new row matches the specified check constraints). But the database will not assume that the constraint holds for all rows in the table, until it is validated by using the <code class="LITERAL">VALIDATE CONSTRAINT</code> option.</p> </dd> <dt><code class="LITERAL">ADD <code class="REPLACEABLE c2">table_constraint_using_index</code></code></dt> <dd> <p>This form adds a new <code class="LITERAL">PRIMARY KEY</code> or <code class="LITERAL">UNIQUE</code> constraint to a table based on an existing unique index. All the columns of the index will be included in the constraint.</p> <p>The index cannot have expression columns nor be a partial index. Also, it must be a b-tree index with default sort ordering. These restrictions ensure that the index is equivalent to one that would be built by a regular <code class="LITERAL">ADD PRIMARY KEY</code> or <code class="LITERAL">ADD UNIQUE</code> command.</p> <p>If <code class="LITERAL">PRIMARY KEY</code> is specified, and the index's columns are not already marked <code class="LITERAL">NOT NULL</code>, then this command will attempt to do <code class="LITERAL">ALTER COLUMN SET NOT NULL</code> against each such column. That requires a full table scan to verify the column(s) contain no nulls. In all other cases, this is a fast operation.</p> <p>If a constraint name is provided then the index will be renamed to match the constraint name. Otherwise the constraint will be named the same as the index.</p> <p>After this command is executed, the index is <span class="QUOTE">"owned"</span> by the constraint, in the same way as if the index had been built by a regular <code class="LITERAL">ADD PRIMARY KEY</code> or <code class="LITERAL">ADD UNIQUE</code> command. In particular, dropping the constraint will make the index disappear too.</p>  <blockquote class="NOTE"> <p><b>Note:</b> Adding a constraint using an existing index can be helpful in situations where a new constraint needs to be added without blocking table updates for a long time. To do that, create the index using <code class="COMMAND">CREATE INDEX CONCURRENTLY</code>, and then install it as an official constraint using this syntax. See the example below.</p> </blockquote>  </dd> <dt><code class="LITERAL">ALTER CONSTRAINT</code></dt> <dd> <p>This form alters the attributes of a constraint that was previously created. Currently only foreign key constraints may be altered.</p> </dd> <dt><code class="LITERAL">VALIDATE CONSTRAINT</code></dt> <dd> <p>This form validates a foreign key or check constraint that was previously created as <code class="LITERAL">NOT VALID</code>, by scanning the table to ensure there are no rows for which the constraint is not satisfied. Nothing happens if the constraint is already marked valid.</p> <p>Validation can be a long process on larger tables. The value of separating validation from initial creation is that you can defer validation to less busy times, or can be used to give additional time to correct pre-existing errors while preventing new errors. Note also that validation on its own does not prevent normal write commands against the table while it runs.</p> <p>Validation acquires only a <code class="LITERAL">SHARE UPDATE EXCLUSIVE</code> lock on the table being altered. If the constraint is a foreign key then a <code class="LITERAL">ROW SHARE</code> lock is also required on the table referenced by the constraint.</p> </dd> <dt><code class="LITERAL">DROP CONSTRAINT [ IF EXISTS ]</code></dt> <dd> <p>This form drops the specified constraint on a table. If <code class="LITERAL">IF EXISTS</code> is specified and the constraint does not exist, no error is thrown. In this case a notice is issued instead.</p> </dd> <dt>
<code class="LITERAL">DISABLE</code>/<code class="LITERAL">ENABLE [ REPLICA | ALWAYS ] TRIGGER</code>
</dt> <dd> <p>These forms configure the firing of trigger(s) belonging to the table. A disabled trigger is still known to the system, but is not executed when its triggering event occurs. For a deferred trigger, the enable status is checked when the event occurs, not when the trigger function is actually executed. One can disable or enable a single trigger specified by name, or all triggers on the table, or only user triggers (this option excludes internally generated constraint triggers such as those that are used to implement foreign key constraints or deferrable uniqueness and exclusion constraints). Disabling or enabling internally generated constraint triggers requires superuser privileges; it should be done with caution since of course the integrity of the constraint cannot be guaranteed if the triggers are not executed. The trigger firing mechanism is also affected by the configuration variable <a href="../runtime-config-client/#GUC-SESSION-REPLICATION-ROLE">session_replication_role</a>. Simply enabled triggers will fire when the replication role is <span class="QUOTE">"origin"</span> (the default) or <span class="QUOTE">"local"</span>. Triggers configured as <code class="LITERAL">ENABLE REPLICA</code> will only fire if the session is in <span class="QUOTE">"replica"</span> mode, and triggers configured as <code class="LITERAL">ENABLE ALWAYS</code> will fire regardless of the current replication mode.</p> <p>This command acquires a <code class="LITERAL">SHARE ROW EXCLUSIVE</code> lock.</p> </dd> <dt>
<code class="LITERAL">DISABLE</code>/<code class="LITERAL">ENABLE [ REPLICA | ALWAYS ] RULE</code>
</dt> <dd> <p>These forms configure the firing of rewrite rules belonging to the table. A disabled rule is still known to the system, but is not applied during query rewriting. The semantics are as for disabled/enabled triggers. This configuration is ignored for <code class="LITERAL">ON SELECT</code> rules, which are always applied in order to keep views working even if the current session is in a non-default replication role.</p> </dd> <dt>
<code class="LITERAL">DISABLE</code>/<code class="LITERAL">ENABLE ROW LEVEL SECURITY</code>
</dt> <dd> <p>These forms control the application of row security policies belonging to the table. If enabled and no policies exist for the table, then a default-deny policy is applied. Note that policies can exist for a table even if row level security is disabled - in this case, the policies will NOT be applied and the policies will be ignored. See also <a href="../sql-createpolicy/">CREATE POLICY</a>.</p> </dd> <dt>
<code class="LITERAL">NO FORCE</code>/<code class="LITERAL">FORCE ROW LEVEL SECURITY</code>
</dt> <dd> <p>These forms control the application of row security policies belonging to the table when the user is the table owner. If enabled, row level security policies will be applied when the user is the table owner. If disabled (the default) then row level security will not be applied when the user is the table owner. See also <a href="../sql-createpolicy/">CREATE POLICY</a>.</p> </dd> <dt><code class="LITERAL">CLUSTER ON</code></dt> <dd> <p>This form selects the default index for future <a href="../sql-cluster/">CLUSTER</a> operations. It does not actually re-cluster the table.</p> <p>Changing cluster options acquires a <code class="LITERAL">SHARE UPDATE EXCLUSIVE</code> lock.</p> </dd> <dt><code class="LITERAL">SET WITHOUT CLUSTER</code></dt> <dd> <p>This form removes the most recently used <a href="../sql-cluster/">CLUSTER</a> index specification from the table. This affects future cluster operations that don't specify an index.</p> <p>Changing cluster options acquires a <code class="LITERAL">SHARE UPDATE EXCLUSIVE</code> lock.</p> </dd> <dt><code class="LITERAL">SET WITH OIDS</code></dt> <dd> <p>This form adds an <code class="LITERAL">oid</code> system column to the table (see <a href="../ddl-system-columns/">Section 5.4</a>). It does nothing if the table already has OIDs.</p> <p>Note that this is not equivalent to <code class="LITERAL">ADD COLUMN oid oid</code>; that would add a normal column that happened to be named <code class="LITERAL">oid</code>, not a system column.</p> </dd> <dt><code class="LITERAL">SET WITHOUT OIDS</code></dt> <dd> <p>This form removes the <code class="LITERAL">oid</code> system column from the table. This is exactly equivalent to <code class="LITERAL">DROP COLUMN oid RESTRICT</code>, except that it will not complain if there is already no <code class="LITERAL">oid</code> column.</p> </dd> <dt><code class="LITERAL">SET TABLESPACE</code></dt> <dd> <p>This form changes the table's tablespace to the specified tablespace and moves the data file(s) associated with the table to the new tablespace. Indexes on the table, if any, are not moved; but they can be moved separately with additional <code class="LITERAL">SET TABLESPACE</code> commands. All tables in the current database in a tablespace can be moved by using the <code class="LITERAL">ALL IN TABLESPACE</code> form, which will lock all tables to be moved first and then move each one. This form also supports <code class="LITERAL">OWNED BY</code>, which will only move tables owned by the roles specified. If the <code class="LITERAL">NOWAIT</code> option is specified then the command will fail if it is unable to acquire all of the locks required immediately. Note that system catalogs are not moved by this command, use <code class="COMMAND">ALTER DATABASE</code> or explicit <code class="COMMAND">ALTER TABLE</code> invocations instead if desired. The <code class="LITERAL">information_schema</code> relations are not considered part of the system catalogs and will be moved. See also <a href="../sql-createtablespace/">CREATE TABLESPACE</a>.</p> </dd> <dt><code class="LITERAL">SET { LOGGED | UNLOGGED }</code></dt> <dd> <p>This form changes the table from unlogged to logged or vice-versa (see <a class="TERM c3" href="../sql-createtable/#SQL-CREATETABLE-UNLOGGED"><code class="LITERAL">UNLOGGED</code></a>). It cannot be applied to a temporary table.</p> </dd> <dt><code class="LITERAL">SET ( <code class="REPLACEABLE c2">storage_parameter</code> = <code class="REPLACEABLE c2">value</code> [, ... ] )</code></dt> <dd> <p>This form changes one or more storage parameters for the table. See <a class="c3" href="../sql-createtable/#SQL-CREATETABLE-STORAGE-PARAMETERS">Storage Parameters</a> for details on the available parameters. Note that the table contents will not be modified immediately by this command; depending on the parameter you might need to rewrite the table to get the desired effects. That can be done with <a href="../sql-vacuum/">VACUUM FULL</a>, <a href="../sql-cluster/">CLUSTER</a> or one of the forms of <code class="COMMAND">ALTER TABLE</code> that forces a table rewrite.</p> <p>Changing fillfactor and autovacuum storage parameters acquires a <code class="LITERAL">SHARE UPDATE EXCLUSIVE</code> lock.</p>  <blockquote class="NOTE"> <p><b>Note:</b> While <code class="COMMAND">CREATE TABLE</code> allows <code class="LITERAL">OIDS</code> to be specified in the <code class="LITERAL">WITH (<code class="REPLACEABLE c2">storage_parameter</code>)</code> syntax, <code class="COMMAND">ALTER TABLE</code> does not treat <code class="LITERAL">OIDS</code> as a storage parameter. Instead use the <code class="LITERAL">SET WITH OIDS</code> and <code class="LITERAL">SET WITHOUT OIDS</code> forms to change OID status.</p> </blockquote>  </dd> <dt><code class="LITERAL">RESET ( <code class="REPLACEABLE c2">storage_parameter</code> [, ... ] )</code></dt> <dd> <p>This form resets one or more storage parameters to their defaults. As with <code class="LITERAL">SET</code>, a table rewrite might be needed to update the table entirely.</p> </dd> <dt><code class="LITERAL">INHERIT <code class="REPLACEABLE c2">parent_table</code></code></dt> <dd> <p>This form adds the target table as a new child of the specified parent table. Subsequently, queries against the parent will include records of the target table. To be added as a child, the target table must already contain all the same columns as the parent (it could have additional columns, too). The columns must have matching data types, and if they have <code class="LITERAL">NOT NULL</code> constraints in the parent then they must also have <code class="LITERAL">NOT NULL</code> constraints in the child.</p> <p>There must also be matching child-table constraints for all <code class="LITERAL">CHECK</code> constraints of the parent, except those marked non-inheritable (that is, created with <code class="LITERAL">ALTER TABLE ... ADD CONSTRAINT ... NO INHERIT</code>) in the parent, which are ignored; all child-table constraints matched must not be marked non-inheritable. Currently <code class="LITERAL">UNIQUE</code>, <code class="LITERAL">PRIMARY KEY</code>, and <code class="LITERAL">FOREIGN KEY</code> constraints are not considered, but this might change in the future.</p> </dd> <dt><code class="LITERAL">NO INHERIT <code class="REPLACEABLE c2">parent_table</code></code></dt> <dd> <p>This form removes the target table from the list of children of the specified parent table. Queries against the parent table will no longer include records drawn from the target table.</p> </dd> <dt><code class="LITERAL">OF <code class="REPLACEABLE c2">type_name</code></code></dt> <dd> <p>This form links the table to a composite type as though <code class="COMMAND">CREATE TABLE OF</code> had formed it. The table's list of column names and types must precisely match that of the composite type; the presence of an <code class="LITERAL">oid</code> system column is permitted to differ. The table must not inherit from any other table. These restrictions ensure that <code class="COMMAND">CREATE TABLE OF</code> would permit an equivalent table definition.</p> </dd> <dt><code class="LITERAL">NOT OF</code></dt> <dd> <p>This form dissociates a typed table from its type.</p> </dd> <dt><code class="LITERAL">OWNER</code></dt> <dd> <p>This form changes the owner of the table, sequence, view, materialized view, or foreign table to the specified user.</p> </dd> <dt id="SQL-CREATETABLE-REPLICA-IDENTITY"><code class="LITERAL">REPLICA IDENTITY</code></dt> <dd> <p>This form changes the information which is written to the write-ahead log to identify rows which are updated or deleted. This option has no effect except when logical replication is in use. <code class="LITERAL">DEFAULT</code> (the default for non-system tables) records the old values of the columns of the primary key, if any. <code class="LITERAL">USING INDEX</code> records the old values of the columns covered by the named index, which must be unique, not partial, not deferrable, and include only columns marked <code class="LITERAL">NOT NULL</code>. <code class="LITERAL">FULL</code> records the old values of all columns in the row. <code class="LITERAL">NOTHING</code> records no information about the old row. (This is the default for system tables.) In all cases, no old values are logged unless at least one of the columns that would be logged differs between the old and new versions of the row.</p> </dd> <dt><code class="LITERAL">RENAME</code></dt> <dd> <p>The <code class="LITERAL">RENAME</code> forms change the name of a table (or an index, sequence, view, materialized view, or foreign table), the name of an individual column in a table, or the name of a constraint of the table. There is no effect on the stored data.</p> </dd> <dt><code class="LITERAL">SET SCHEMA</code></dt> <dd> <p>This form moves the table into another schema. Associated indexes, constraints, and sequences owned by table columns are moved as well.</p> </dd> </dl> </div> <p>All the forms of ALTER TABLE that act on a single table, except <code class="LITERAL">RENAME</code>, and <code class="LITERAL">SET SCHEMA</code> can be combined into a list of multiple alterations to applied together. For example, it is possible to add several columns and/or alter the type of several columns in a single command. This is particularly useful with large tables, since only one pass over the table need be made.</p> <p>You must own the table to use <code class="COMMAND">ALTER TABLE</code>. To change the schema or tablespace of a table, you must also have <code class="LITERAL">CREATE</code> privilege on the new schema or tablespace. To add the table as a new child of a parent table, you must own the parent table as well. To alter the owner, you must also be a direct or indirect member of the new owning role, and that role must have <code class="LITERAL">CREATE</code> privilege on the table's schema. (These restrictions enforce that altering the owner doesn't do anything you couldn't do by dropping and recreating the table. However, a superuser can alter ownership of any table anyway.) To add a column or alter a column type or use the <code class="LITERAL">OF</code> clause, you must also have <code class="LITERAL">USAGE</code> privilege on the data type.</p> </div> <div class="REFSECT1" id="AEN75679">  <h2>Parameters</h2> <div class="VARIABLELIST"> <dl> <dt><code class="LITERAL">IF EXISTS</code></dt> <dd> <p>Do not throw an error if the table does not exist. A notice is issued in this case.</p> </dd> <dt><code class="REPLACEABLE c2">name</code></dt> <dd> <p>The name (optionally schema-qualified) of an existing table to alter. If <code class="LITERAL">ONLY</code> is specified before the table name, only that table is altered. If <code class="LITERAL">ONLY</code> is not specified, the table and all its descendant tables (if any) are altered. Optionally, <code class="LITERAL">*</code> can be specified after the table name to explicitly indicate that descendant tables are included.</p> </dd> <dt><code class="REPLACEABLE c2">column_name</code></dt> <dd> <p>Name of a new or existing column.</p> </dd> <dt><code class="REPLACEABLE c2">new_column_name</code></dt> <dd> <p>New name for an existing column.</p> </dd> <dt><code class="REPLACEABLE c2">new_name</code></dt> <dd> <p>New name for the table.</p> </dd> <dt><code class="REPLACEABLE c2">data_type</code></dt> <dd> <p>Data type of the new column, or new data type for an existing column.</p> </dd> <dt><code class="REPLACEABLE c2">table_constraint</code></dt> <dd> <p>New table constraint for the table.</p> </dd> <dt><code class="REPLACEABLE c2">constraint_name</code></dt> <dd> <p>Name of a new or existing constraint.</p> </dd> <dt><code class="LITERAL">CASCADE</code></dt> <dd> <p>Automatically drop objects that depend on the dropped column or constraint (for example, views referencing the column), and in turn all objects that depend on those objects (see <a href="../ddl-depend/">Section 5.13</a>).</p> </dd> <dt><code class="LITERAL">RESTRICT</code></dt> <dd> <p>Refuse to drop the column or constraint if there are any dependent objects. This is the default behavior.</p> </dd> <dt><code class="REPLACEABLE c2">trigger_name</code></dt> <dd> <p>Name of a single trigger to disable or enable.</p> </dd> <dt><code class="LITERAL">ALL</code></dt> <dd> <p>Disable or enable all triggers belonging to the table. (This requires superuser privilege if any of the triggers are internally generated constraint triggers such as those that are used to implement foreign key constraints or deferrable uniqueness and exclusion constraints.)</p> </dd> <dt><code class="LITERAL">USER</code></dt> <dd> <p>Disable or enable all triggers belonging to the table except for internally generated constraint triggers such as those that are used to implement foreign key constraints or deferrable uniqueness and exclusion constraints.</p> </dd> <dt><code class="REPLACEABLE c2">index_name</code></dt> <dd> <p>The name of an existing index.</p> </dd> <dt><code class="REPLACEABLE c2">storage_parameter</code></dt> <dd> <p>The name of a table storage parameter.</p> </dd> <dt><code class="REPLACEABLE c2">value</code></dt> <dd> <p>The new value for a table storage parameter. This might be a number or a word depending on the parameter.</p> </dd> <dt><code class="REPLACEABLE c2">parent_table</code></dt> <dd> <p>A parent table to associate or de-associate with this table.</p> </dd> <dt><code class="REPLACEABLE c2">new_owner</code></dt> <dd> <p>The user name of the new owner of the table.</p> </dd> <dt><code class="REPLACEABLE c2">new_tablespace</code></dt> <dd> <p>The name of the tablespace to which the table will be moved.</p> </dd> <dt><code class="REPLACEABLE c2">new_schema</code></dt> <dd> <p>The name of the schema to which the table will be moved.</p> </dd> </dl> </div> </div> <div class="REFSECT1" id="AEN75786">  <h2>Notes</h2> <p>The key word <code class="LITERAL">COLUMN</code> is noise and can be omitted.</p> <p>When a column is added with <code class="LITERAL">ADD COLUMN</code>, all existing rows in the table are initialized with the column's default value (NULL if no <code class="LITERAL">DEFAULT</code> clause is specified). If there is no <code class="LITERAL">DEFAULT</code> clause, this is merely a metadata change and does not require any immediate update of the table's data; the added NULL values are supplied on readout, instead.</p> <p>Adding a column with a <code class="LITERAL">DEFAULT</code> clause or changing the type of an existing column will require the entire table and its indexes to be rewritten. As an exception when changing the type of an existing column, if the <code class="LITERAL">USING</code> clause does not change the column contents and the old type is either binary coercible to the new type or an unconstrained domain over the new type, a table rewrite is not needed; but any indexes on the affected columns must still be rebuilt. Adding or removing a system <code class="LITERAL">oid</code> column also requires rewriting the entire table. Table and/or index rebuilds may take a significant amount of time for a large table; and will temporarily require as much as double the disk space.</p> <p>Adding a <code class="LITERAL">CHECK</code> or <code class="LITERAL">NOT NULL</code> constraint requires scanning the table to verify that existing rows meet the constraint, but does not require a table rewrite.</p> <p>The main reason for providing the option to specify multiple changes in a single <code class="COMMAND">ALTER TABLE</code> is that multiple table scans or rewrites can thereby be combined into a single pass over the table.</p> <p>The <code class="LITERAL">DROP COLUMN</code> form does not physically remove the column, but simply makes it invisible to SQL operations. Subsequent insert and update operations in the table will store a null value for the column. Thus, dropping a column is quick but it will not immediately reduce the on-disk size of your table, as the space occupied by the dropped column is not reclaimed. The space will be reclaimed over time as existing rows are updated. (These statements do not apply when dropping the system <code class="LITERAL">oid</code> column; that is done with an immediate rewrite.)</p> <p>To force immediate reclamation of space occupied by a dropped column, you can execute one of the forms of <code class="COMMAND">ALTER TABLE</code> that performs a rewrite of the whole table. This results in reconstructing each row with the dropped column replaced by a null value.</p> <p>The rewriting forms of <code class="COMMAND">ALTER TABLE</code> are not MVCC-safe. After a table rewrite, the table will appear empty to concurrent transactions, if they are using a snapshot taken before the rewrite occurred. See <a href="../mvcc-caveats/">Section 13.5</a> for more details.</p> <p>The <code class="LITERAL">USING</code> option of <code class="LITERAL">SET DATA TYPE</code> can actually specify any expression involving the old values of the row; that is, it can refer to other columns as well as the one being converted. This allows very general conversions to be done with the <code class="LITERAL">SET DATA TYPE</code> syntax. Because of this flexibility, the <code class="LITERAL">USING</code> expression is not applied to the column's default value (if any); the result might not be a constant expression as required for a default. This means that when there is no implicit or assignment cast from old to new type, <code class="LITERAL">SET DATA TYPE</code> might fail to convert the default even though a <code class="LITERAL">USING</code> clause is supplied. In such cases, drop the default with <code class="LITERAL">DROP DEFAULT</code>, perform the <code class="LITERAL">ALTER TYPE</code>, and then use <code class="LITERAL">SET DEFAULT</code> to add a suitable new default. Similar considerations apply to indexes and constraints involving the column.</p> <p>If a table has any descendant tables, it is not permitted to add, rename, or change the type of a column, or rename an inherited constraint in the parent table without doing the same to the descendants. That is, <code class="COMMAND">ALTER TABLE ONLY</code> will be rejected. This ensures that the descendants always have columns matching the parent.</p> <p>A recursive <code class="LITERAL">DROP COLUMN</code> operation will remove a descendant table's column only if the descendant does not inherit that column from any other parents and never had an independent definition of the column. A nonrecursive <code class="LITERAL">DROP COLUMN</code> (i.e., <code class="COMMAND">ALTER TABLE ONLY ... DROP COLUMN</code>) never removes any descendant columns, but instead marks them as independently defined rather than inherited.</p> <p>The <code class="LITERAL">TRIGGER</code>, <code class="LITERAL">CLUSTER</code>, <code class="LITERAL">OWNER</code>, and <code class="LITERAL">TABLESPACE</code> actions never recurse to descendant tables; that is, they always act as though <code class="LITERAL">ONLY</code> were specified. Adding a constraint recurses only for <code class="LITERAL">CHECK</code> constraints that are not marked <code class="LITERAL">NO INHERIT</code>.</p> <p>Changing any part of a system catalog table is not permitted.</p> <p>Refer to <a href="../sql-createtable/">CREATE TABLE</a> for a further description of valid parameters. <a href="https://www.postgresql.org/docs/9.6/static/ddl.html" target="_blank">Chapter 5</a> has further information on inheritance.</p> </div> <div class="REFSECT1" id="AEN75839">  <h2>Examples</h2> <p>To add a column of type <code class="TYPE">varchar</code> to a table:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD COLUMN address varchar(30);
</pre> <p>To drop a column from a table:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors DROP COLUMN address RESTRICT;
</pre> <p>To change the types of two existing columns in one operation:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors
    ALTER COLUMN address TYPE varchar(80),
    ALTER COLUMN name TYPE varchar(100);
</pre> <p>To change an integer column containing Unix timestamps to <code class="TYPE">timestamp with time zone</code> via a <code class="LITERAL">USING</code> clause:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE foo
    ALTER COLUMN foo_timestamp SET DATA TYPE timestamp with time zone
    USING
        timestamp with time zone 'epoch' + foo_timestamp * interval '1 second';
</pre> <p>The same, when the column has a default expression that won't automatically cast to the new data type:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE foo
    ALTER COLUMN foo_timestamp DROP DEFAULT,
    ALTER COLUMN foo_timestamp TYPE timestamp with time zone
    USING
        timestamp with time zone 'epoch' + foo_timestamp * interval '1 second',
    ALTER COLUMN foo_timestamp SET DEFAULT now();
</pre> <p>To rename an existing column:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors RENAME COLUMN address TO city;
</pre> <p>To rename an existing table:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors RENAME TO suppliers;
</pre> <p>To rename an existing constraint:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors RENAME CONSTRAINT zipchk TO zip_check;
</pre> <p>To add a not-null constraint to a column:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ALTER COLUMN street SET NOT NULL;
</pre> <p>To remove a not-null constraint from a column:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ALTER COLUMN street DROP NOT NULL;
</pre> <p>To add a check constraint to a table and all its children:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD CONSTRAINT zipchk CHECK (char_length(zipcode) = 5);
</pre> <p>To add a check constraint only to a table and not to its children:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD CONSTRAINT zipchk CHECK (char_length(zipcode) = 5) NO INHERIT;
</pre> <p>(The check constraint will not be inherited by future children, either.)</p> <p>To remove a check constraint from a table and all its children:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors DROP CONSTRAINT zipchk;
</pre> <p>To remove a check constraint from one table only:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE ONLY distributors DROP CONSTRAINT zipchk;
</pre> <p>(The check constraint remains in place for any child tables.)</p> <p>To add a foreign key constraint to a table:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD CONSTRAINT distfk FOREIGN KEY (address) REFERENCES addresses (address);
</pre> <p>To add a foreign key constraint to a table with the least impact on other work:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD CONSTRAINT distfk FOREIGN KEY (address) REFERENCES addresses (address) NOT VALID;
ALTER TABLE distributors VALIDATE CONSTRAINT distfk;
</pre> <p>To add a (multicolumn) unique constraint to a table:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD CONSTRAINT dist_id_zipcode_key UNIQUE (dist_id, zipcode);
</pre> <p>To add an automatically named primary key constraint to a table, noting that a table can only ever have one primary key:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors ADD PRIMARY KEY (dist_id);
</pre> <p>To move a table to a different tablespace:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE distributors SET TABLESPACE fasttablespace;
</pre> <p>To move a table to a different schema:</p> <pre class="PROGRAMLISTING" data-language="sql">
ALTER TABLE myschema.distributors SET SCHEMA yourschema;
</pre> <p>To recreate a primary key constraint, without blocking updates while the index is rebuilt:</p> <pre class="PROGRAMLISTING" data-language="sql">
CREATE UNIQUE INDEX CONCURRENTLY dist_id_temp_idx ON distributors (dist_id);
ALTER TABLE distributors DROP CONSTRAINT distributors_pkey,
    ADD CONSTRAINT distributors_pkey PRIMARY KEY USING INDEX dist_id_temp_idx;
</pre> </div> <div class="REFSECT1" id="AEN75885">  <h2>Compatibility</h2> <p>The forms <code class="LITERAL">ADD</code> (without <code class="LITERAL">USING INDEX</code>), <code class="LITERAL">DROP</code>, <code class="LITERAL">SET DEFAULT</code>, and <code class="LITERAL">SET DATA TYPE</code> (without <code class="LITERAL">USING</code>) conform with the SQL standard. The other forms are <span class="PRODUCTNAME">PostgreSQL</span> extensions of the SQL standard. Also, the ability to specify more than one manipulation in a single <code class="COMMAND">ALTER TABLE</code> command is an extension.</p> <p><code class="COMMAND">ALTER TABLE DROP COLUMN</code> can be used to drop the only column of a table, leaving a zero-column table. This is an extension of SQL, which disallows zero-column tables.</p> </div> <div class="REFSECT1" id="AEN75898">  <h2>See Also</h2>
<a href="../sql-createtable/">CREATE TABLE</a> </div> <div class="NAVFOOTER">  <table summary="Footer navigation table"> <tr> <td width="33%" align="left"><a href="../sql-altersystem/" accesskey="P">Prev</a></td> <td width="34%" align="center"></td> <td width="33%" align="right"><a href="../sql-altertablespace/" accesskey="N">Next</a></td> </tr> <tr> <td width="33%" align="left">ALTER SYSTEM</td> <td width="34%" align="center"><a href="https://www.postgresql.org/docs/9.6/static/sql-commands.html" accesskey="U" target="_blank">Up</a></td> <td width="33%" align="right">ALTER TABLESPACE</td> </tr> </table> </div>
<div class="_attribution">
  <p class="_attribution-p">
    © 1996–2017 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/9.6/static/sql-altertable.html" class="_attribution-link" target="_blank">https://www.postgresql.org/docs/9.6/static/sql-altertable.html</a>
  </p>
</div>

			</div>
		</div>
	</section>

	</div>
</body>
</html>
